author: e1abrador (Eric Labrador)
name: find_all_certificate_templates
state: enabled
tactic: collection
tag: analysis
description: All certificate templates.
statement:
  main: >-
     MATCH (n:CertificateTemplate{domain:'RAS-DOMAIN'})
     RETURN n.`Template Name` AS `Template Name`, n.Enabled AS `Template Enabled`, n.highvalue AS `High Value Target`, n.`Validity Period` AS `Validity Period`, n.`Client Authentication` AS `Client Authentication`, n.`Requires Manager Approval` AS `Requires Manager Approval`
     ORDER BY `Template Name` ASC
nextsteps:
    rt:
      - Check all the output files to look for template misconfigurations - ESC[1-8]
    bt:
      - Certificate templates inventory for blue team.
