author: rastreator
name: computers_and_os
state: enabled
tactic: discovery
tag: analysis
description: Get computers names and operating system
sentence:
  table: >-
    match (c:Computer{enabled:true})
    return c.name as Name, c.operatingsystem as OperatingSystem
    order by OperatingSystem, Name asc
  count:
      - return .*?OperatingSystem/return c.operatingsystem as OperatingSystem, count(c.operatingsystem) as Count 
      - order by .*/order by Count desc
