author: rastreator
name: outdated_computers
state: enabled
tactic: lateral movement
tag: issue
description: Get outdated computers names and operating system.
sentence:
  table: >-
    match (c:Computer{enabled:true})
    where c.operatingsystem =~ '(?i).*(XP|ME|7|2003|2008).*'
    return c.name as Name, c.operatingsystem as OperatingSystem
    order by OperatingSystem, Name asc
  count:
    - return .* order/return c.operatingsystem as OperatingSystem, count(*) as Count order
    - order .*/order by Count desc
nextsteps:
  rt:
    - Check them for known vulnerabilities.
    - Compromise them.
  bt:
    - Update, isolate or shutdown them.
